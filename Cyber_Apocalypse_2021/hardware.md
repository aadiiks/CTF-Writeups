# Hardware

* `.sal` files are saleae logic analyzer files. 
* I got this as reference https://dystopia.sg/allesctf20-PWNkemon/
so i downloaded the sla logic analyzer
https://www.saleae.com/downloads/
* from here after installing, i opened the sal files which i could and then the following:


## Serial Logs:

* I imported the value i am pretty sure if i find the right analyzer it should work

![](https://i.imgur.com/6xBDd1n.png)

* by far for this challenge async serial works the best
* challenge states raspberry pi which has a baud rate of 115200
* after some pondering i realized that there are some errors in parity on fixing them and using the `115200` in async serial we get the hex converting which gives us this:

https://www.dropbox.com/s/ztqoa16wvp6rvf6/message.txt?dl=0

![](https://i.imgur.com/q7NthH4.png)

* found this : https://6e726d.github.io/Challenge/Ekoparty15/
* this writeup explains how to get the baud rate
* open the SAL file and zoom

![](https://i.imgur.com/xxeLOug.png)

* zoom 

![](https://i.imgur.com/MJcGAl0.png)

* zoom

![](https://i.imgur.com/wdJWXAt.png)

* zoom 

![](https://i.imgur.com/mcmgkkb.png)

* until you see the smallest unit of the digital wave then measure it: as its 13.498

![](https://i.imgur.com/zs07dga.png)

* since it is in **Î¼** we will divide it by 1000000
* so 1000000/13.498 = 74085.049637
* I obviously used 74000 as bit rate, converted the hex to ascii with the tool itself and it gave me the flag:

```
CHTB{wh47?!_f23qu3ncy_h0pp1n9_1n_4_532141_p2070c01?!!!52}
```

---

## Compromised

* import the file in salea logic analyzer, and use i2c analyzer
* export the data and you will see two columns if we take everything written and try the  hex dump we get

```
set_maCxH_lTimB{itn_tuo1:110_se73t_2mimn1_nli4mi70t_2to5:_1c0+.]<+/4~nr^_yz82Gb3b"4#kU_..4+J_5.
```
```
3M.2B1.4B.1dV_5. yS.5B7k3..1V.Qxm.!j.@Q52yq)t%# @5%md}S.
```

* and we can see its slightly off i noticed the following :

![](https://i.imgur.com/G8k8snr.png)

* so i used only `0x2C` used the corresponding hex 

which is 

```
0x43 0x48 0x54 0x42 0x7B 0x6E 0x75 0x31 0x31 0x5F 0x37 0x33 0x32 0x6D 0x31 0x6E 0x34 0x37 0x30 0x32 0x35 0x5F 0x63 0x34 0x6E 0x5F 0x38 0x32 0x33 0x34 0x6B 0x5F 0x34 0x5F 0x35 0x33 0x32 0x31 0x34 0x31 0x5F 0x35 0x79 0x35 0x37 0x33 0x6D 0x21 0x40 0x35 0x32 0x29 0x23 0x40 0x25 0x7D
```

* and got the flag 

```
CHTB{nu11_732m1n47025_c4n_8234k_4_532141_5y573m!@52)#@%}
```

## OR

>An embedded device in our serial network exploited a misconfiguration which resulted in the compromisation of several of our slave devices in it, leaving the base camp exposed to intruders. We must find what alterations the device did over the network in order to revert them before its too late
This challenge will raise 33 euros for a good cause.

downloaded Logic-2.3.26-master.AppImage and opened the file (.sal) then clicked F1 button on the right and choosed channel 0 and 1 then the data apeared

![](https://i.imgur.com/s2wh7PA.png)

```
write to 0x34 ack data: 0x73 
write to 0x34 ack data: 0x65 
write to 0x34 ack data: 0x74 
write to 0x34 ack data: 0x5F 
write to 0x34 ack data: 0x6D 
write to 0x34 ack data: 0x61 
write to 0x2C ack data: 0x43 
write to 0x34 ack data: 0x78 
write to 0x2C ack data: 0x48 
write to 0x34 ack data: 0x5F 
write to 0x34 ack data: 0x6C 
write to 0x2C ack data: 0x54 
write to 0x34 ack data: 0x69 
write to 0x34 ack data: 0x6D 
write to 0x2C ack data: 0x42 
write to 0x2C ack data: 0x7B 
write to 0x34 ack data: 0x69 
write to 0x34 ack data: 0x74 
write to 0x2C ack data: 0x6E 
write to 0x34 ack data: 0x5F 
write to 0x34 ack data: 0x74 
write to 0x2C ack data: 0x75 
write to 0x34 ack data: 0x6F 
write to 0x2C ack data: 0x31 
write to 0x34 ack data: 0x3A 
write to 0x2C ack data: 0x31 
write to 0x34 ack data: 0x31 
write to 0x34 ack data: 0x30 
write to 0x2C ack data: 0x5F 
write to 0x04 nak
write to 0x34 ack data: 0x73 
write to 0x34 ack data: 0x65 
write to 0x2C ack data: 0x37 
write to 0x2C ack data: 0x33 
write to 0x34 ack data: 0x74 
write to 0x34 ack data: 0x5F 
write to 0x2C ack data: 0x32 
write to 0x34 ack data: 0x6D 
write to 0x34 ack data: 0x69 
write to 0x2C ack data: 0x6D 
write to 0x34 ack data: 0x6E 
write to 0x2C ack data: 0x31 
write to 0x34 ack data: 0x5F 
write to 0x2C ack data: 0x6E 
write to 0x34 ack data: 0x6C 
write to 0x34 ack data: 0x69 
write to 0x2C ack data: 0x34 
write to 0x34 ack data: 0x6D 
write to 0x34 ack data: 0x69 
write to 0x2C ack data: 0x37 
write to 0x2C ack data: 0x30 
write to 0x34 ack data: 0x74 
write to 0x34 ack data: 0x5F 
write to 0x2C ack data: 0x32 
write to 0x34 ack data: 0x74 
write to 0x34 ack data: 0x6F 
write to 0x2C ack data: 0x35 
write to 0x34 ack data: 0x3A 
write to 0x2C ack data: 0x5F 
write to 0x34 ack data: 0x31 
write to 0x2C ack data: 0x63 
write to 0x34 ack data: 0x30 
write to 0x04 nak
write to 0x34 ack data: 0x2B 
write to 0x34 ack data: 0x1D 
write to 0x34 ack data: 0x5D 
write to 0x34 ack data: 0x3C 
write to 0x34 ack data: 0x2B 
write to 0x34 ack data: 0x2F 
write to 0x2C ack data: 0x34 
write to 0x34 ack data: 0x7E 
write to 0x2C ack data: 0x6E 
write to 0x34 ack data: 0x72 
write to 0x34 ack data: 0x5E 
write to 0x2C ack data: 0x5F 
write to 0x34 ack data: 0x79 
write to 0x34 ack data: 0x7A 
write to 0x2C ack data: 0x38 
write to 0x2C ack data: 0x32 
write to 0x34 ack data: 0x47 
write to 0x34 ack data: 0x62 
write to 0x2C ack data: 0x33 
write to 0x34 ack data: 0x62 
write to 0x34 ack data: 0x22 
write to 0x2C ack data: 0x34 
write to 0x34 ack data: 0x23 
write to 0x2C ack data: 0x6B 
write to 0x34 ack data: 0x55 
write to 0x2C ack data: 0x5F 
write to 0x34 ack data: 0x16 
write to 0x34 ack data: 0x03 
write to 0x2C ack data: 0x34 
write to 0x04 nak
write to 0x34 ack data: 0x2B 
write to 0x34 ack data: 0x4A 
write to 0x2C ack data: 0x5F 
write to 0x2C ack data: 0x35 
write to 0x34 ack data: 0x01 
write to 0x34 ack data: 0x0D 
write to 0x2C ack data: 0x33 
write to 0x34 ack data: 0x4D 
write to 0x34 ack data: 0x0E 
write to 0x2C ack data: 0x32 
write to 0x34 ack data: 0x42 
write to 0x2C ack data: 0x31 
write to 0x34 ack data: 0x00 
write to 0x2C ack data: 0x34 
write to 0x34 ack data: 0x42 
write to 0x34 ack data: 0x12 
write to 0x2C ack data: 0x31 
write to 0x34 ack data: 0x64 
write to 0x34 ack data: 0x56 
write to 0x2C ack data: 0x5F 
write to 0x2C ack data: 0x35 
write to 0x34 ack data: 0x07 
write to 0x34 ack data: 0x20 
write to 0x2C ack data: 0x79 
write to 0x34 ack data: 0x53 
write to 0x34 ack data: 0x05 
write to 0x2C ack data: 0x35 
write to 0x34 ack data: 0x42 
write to 0x2C ack data: 0x37 
write to 0x34 ack data: 0x6B 
write to 0x2C ack data: 0x33 
write to 0x34 ack data: 0x1D 
write to 0x04 nak
write to 0x34 ack data: 0x1A 
write to 0x34 ack data: 0x31 
write to 0x34 ack data: 0x56 
write to 0x34 ack data: 0x05 
write to 0x34 ack data: 0x51 
write to 0x34 ack data: 0x78 
write to 0x2C ack data: 0x6D 
write to 0x34 ack data: 0x14 
write to 0x2C ack data: 0x21 
write to 0x34 ack data: 0x6A 
write to 0x34 ack data: 0x16 
write to 0x2C ack data: 0x40 
write to 0x34 ack data: 0x60 
write to 0x34 ack data: 0x51 
write to 0x2C ack data: 0x35 
write to 0x2C ack data: 0x32 
write to 0x34 ack data: 0x79 
write to 0x34 ack data: 0x71 
write to 0x2C ack data: 0x29 
write to 0x34 ack data: 0x74 
write to 0x34 ack data: 0x25 
write to 0x2C ack data: 0x23 
write to 0x34 ack data: 0x20 
write to 0x2C ack data: 0x40 
write to 0x34 ack data: 0x35 
write to 0x2C ack data: 0x25 
write to 0x34 ack data: 0x6D 
write to 0x34 ack data: 0x64 
write to 0x2C ack data: 0x7D 
write to 0x04 nak
write to 0x34 ack data: 0x53 
write to 0x34 ack data: 0x16
```
this is the output if we get all the data of all adresses (0x34, 0x2C, 0x04)

>set_maCxH_lTimB{itn_tuo1:110_se73t_2mimn1_nli4mi70t_2to5:

so if the 7th pos is C which is the begining of the flag BUT has address 0x2C, so i filtered by that adress by the below script and that gave the flag

```
f = open("add", "r")
f2 = open("hex", "r")
Lines = f.readlines()
Lines2 = f2.readlines()
i=0
for i in range(len(Lines)):
	if Lines[i] == "0x2C\n":
		print(Lines2[i])
```
add=
```
0x34
0x34
0x34
0x34
0x34
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x04
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x04
0x34
0x34
0x34
0x34
0x34
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x04
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x04
0x34
0x34
0x34
0x34
0x34
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x2C
0x34
0x34
0x2C
0x34
0x34
0x2C
0x34
0x2C
0x34
0x2C
0x34
0x34
0x2C
0x04
0x34
0x34
```
hex=
```
73 65 74 5F 6D 61 43 78 48 5F 6C 54 69 6D 42 7B 69 74 6E 5F 74 75 6F 31 3A 31 31 30 5F  73 65 37 33 74 5F 32 6D 69 6D 6E 31 5F 6E 6C 69 34 6D 69 37 30 74 5F 32 74 6F 35 3A 5F 31 63 30  2B 1D 5D 3C 2B 2F 34 7E 6E 72 5E 5F 79 7A 38 32 47 62 33 62 22 34 23 6B 55 5F 16 03 34  2B 4A 5F 35 01 0D 33 4D 0E 32 42 31 00 34 42 12 31 64 56 5F 35 07 20 79 53 05 35 42 37 6B 33 1D  1A 31 56 05 51 78 6D 14 21 6A 16 40 60 51 35 32 79 71 29 74 25 23 20 40 35 25 6D 64 7D  53 16 
```
res= 
```
43  48  54  42  7B  6E  75  31  31  5F  37  33  32  6D  31  6E  34  37  30  32  35  5F  63  34  6E  5F  38  32  33  34  6B  5F  34  5F  35  33  32  31  34  31  5F  35  79  35  37  33  6D  21  40  35  32  29  23  40  25  7D
```
### Flag
```
CHTB{nu11_732m1n47025_c4n_8234k_4_532141_5y573m!@52)#@%}
```
